# SymPy 绘图实验报告

## 一、实验信息

- 小组名称：cp002
- 成员：叶瑞昀、曹玉琴、钱曼聆、陶涵希
- 实验日期：2025.4.9

---

## 二、实验目的

- 熟悉SymPy的plot、plot_implicit、和plot3d_parametric_surface函数；
- 掌握曲线、隐函数和参数曲面的绘制方法。

---

## 三、实验内容与方法

分别说明三个问题的具体绘图方法和使用的函数接口。
以下是三个问题的具体绘图方法和使用的函数接口说明：

---

### **问题 1：绘制函数 `cos(tan(pi*x))` 的图像**
#### 方法：
1. 使用 `sympy.plotting.plot` 函数绘制函数图像。
2. 定义符号变量 `x` 和表达式 `cos(tan(pi*x))`。
3. 设置绘图范围为 `x ∈ [-1, 1]`。
4. 添加坐标轴标签 `xlabel='x'` 和 `ylabel='cos(tan(pi*x))'`，以及标题 `title='Function Plot'`。

#### 函数接口：
```python
plot(expr, (var, start, end), xlabel='x', ylabel='y', title='Title', show=True)
```
- `expr`：要绘制的表达式。
- `(var, start, end)`：变量及其范围。
- `xlabel` 和 `ylabel`：坐标轴标签。
- `title`：图像标题。
- `show`：是否显示图像，默认为 `True`。

---

### **问题 2：绘制隐函数 `e^y + cos(x)/x + y = 0` 的图像**
#### 方法：
1. 使用 `sympy.plotting.plot_implicit` 函数绘制隐函数图像。
2. 定义符号变量 `x` 和 `y`。
3. 定义隐函数表达式 `e^y + cos(x)/x + y = 0`。
4. 设置绘图区间为 `x ∈ [-10, 10]` 和 `y ∈ [-10, 10]`，避免 `x=0` 的除零错误。
5. 添加坐标轴标签 `xlabel='x'` 和 `ylabel='y'`，以及标题 `title='Implicit Function Plot'`。
6. 设置 `points=500` 参数以提高图像质量。

#### 函数接口：
```python
plot_implicit(expr, (x, x_start, x_end), (y, y_start, y_end), xlabel='x', ylabel='y', title='Title', points=500, show=True)
```
- `expr`：隐函数表达式，通常使用 `sp.Eq()` 定义。
- `(x, x_start, x_end)` 和 `(y, y_start, y_end)`：变量及其范围。
- `xlabel` 和 `ylabel`：坐标轴标签。
- `title`：图像标题。
- `points`：采样点数量，默认值为 300。
- `show`：是否显示图像，默认为 `True`。

---

### **问题 3：绘制三维参数曲面**
#### 方法：
1. 使用 `sympy.plotting.plot3d_parametric_surface` 函数绘制三维参数曲面。
2. 定义符号变量 `s` 和 `t`。
3. 定义参数方程：
   - `x = exp(-s) * cos(t)`
   - `y = exp(-s) * sin(t)`
   - `z = t`
4. 设置参数范围为 `s ∈ [0, 8]` 和 `t ∈ [0, 5*pi]`。
5. 添加坐标轴标签 `xlabel='x'`、`ylabel='y'` 和 `zlabel='z'`，以及标题 `title='3D Parametric Surface'`。

#### 函数接口：
```python
plot3d_parametric_surface(x_expr, y_expr, z_expr, (u, u_start, u_end), (v, v_start, v_end), xlabel='x', ylabel='y', zlabel='z', title='Title', show=True)
```
- `x_expr`、`y_expr` 和 `z_expr`：参数方程的表达式。
- `(u, u_start, u_end)` 和 `(v, v_start, v_end)`：参数及其范围。
- `xlabel`、`ylabel` 和 `zlabel`：坐标轴标签。
- `title`：图像标题。
- `show`：是否显示图像，默认为 `True`。

---

### 总结
- **问题 1** 使用 `plot` 函数绘制一维函数图像。
- **问题 2** 使用 `plot_implicit` 函数绘制隐函数图像。
- **问题 3** 使用 `plot3d_parametric_surface` 函数绘制三维参数曲面。


---

## 四、实验结果与分析

### 问题1: 函数曲线 $\cos(\tan(\pi x))$ 绘制结果

![problem1_plot](https://github.com/user-attachments/assets/1efd607c-e964-4890-bce3-6c8f7d055452)

绘制结果特点：
#### 周期性：

函数 $\cos(\tan(\pi x))$ 是由 $\cos$ 和 $\tan$ 组合而成。
$\tan(\pi x)$ 在 $x = \pm 0.5, \pm 1.5, \pm 2.5, \dots$ 处会趋于无穷大，因此 $\cos(\tan(\pi x))$ 在这些点附近会表现出快速振荡。
#### 振荡性：

$\cos$ 函数的值域为 $[-1, 1]$，因此 $\cos(\tan(\pi x))$ 的值域也限制在 $[-1, 1]$。
由于 $\tan(\pi x)$ 的非线性增长，$\cos(\tan(\pi x))$ 的振荡频率会随着 $x$ 的变化变得不规则。
#### 对称性：

$\tan(\pi x)$ 是奇函数，而 $\cos$ 是偶函数，因此 $\cos(\tan(\pi x))$ 是偶函数，即关于 $y$ 轴对称。
#### 间断性：

$\tan(\pi x)$ 在 $x = \pm 0.5, \pm 1.5, \dots$ 处无定义，因此 $\cos(\tan(\pi x))$ 在这些点附近会出现间断。
#### 简要分析：
在绘制区间 $x \in [-1, 1]$ 内，函数 $\cos(\tan(\pi x))$ 会在 $x = -0.5$ 和 $x = 0.5$ 附近表现出剧烈的振荡。
曲线在 $x = 0$ 附近较为平滑，因为 $\tan(\pi x)$ 在 $x = 0$ 附近变化较慢。
由于 $\tan(\pi x)$ 的间断性，曲线在 $x = \pm 0.5$ 附近会出现不连续的跳跃。

### 问题2: 隐函数曲线 $e^y + \frac{\cos x}{x} + y = 0$ 绘制结果
![problem2_plot](https://github.com/user-attachments/assets/f8cf3d37-0979-433e-9ad6-b7458b7d209b)


### 绘制结果特点：
#### 隐函数的复杂性：

隐函数 $e^y + \frac{\cos x}{x} + y = 0$ 不能直接解出 $y$ 关于 $x$ 的显式表达式，因此需要使用隐函数绘图方法。
由于 $\frac{\cos x}{x}$ 在 $x = 0$ 处无定义，曲线在 $x = 0$ 附近会出现间断。
#### 曲线的分布：

在 $x > 0$ 和 $x < 0$ 的区域，曲线呈现对称性，但由于 $e^y$ 的指数增长特性，$y$ 的值在 $x$ 的不同区域可能变化较大。
曲线在 $x$ 远离 0 时趋于平滑，而在 $x$ 接近 0 时可能出现较大的变化。
#### 间断性：

由于 $\frac{\cos x}{x}$ 的分母为 0 时无定义，曲线在 $x = 0$ 附近会出现间断。
在绘图时需要避开 $x = 0$ 的区域，通常设置 $x$ 的范围为 $[-10, -0.1] \cup [0.1, 10]$。
#### 振荡性：

$\frac{\cos x}{x}$ 的振荡性会导致曲线在 $x$ 远离 0 时呈现周期性波动。

### 运行结果：
图像会显示在 $x \in [-10, 10]$ 和 $y \in [-10, 10]$ 的范围内。
在 $x = 0$ 附近会出现间断，曲线在 $x > 0$ 和 $x < 0$ 的区域分别绘制。
曲线在 $x$ 远离 0 时较为平滑，而在 $x$ 接近 0 时可能出现剧烈变化。

### 简要分析：
间断性：由于 $\frac{\cos x}{x}$ 的分母为 0，曲线在 $x = 0$ 附近会出现间断。

振荡性：$\frac{\cos x}{x}$ 的振荡性会导致曲线在 $x$ 远离 0 时呈现周期性波动。

指数增长：$e^y$ 的指数增长特性会使得 $y$ 在某些区域迅速增大或减小。

对称性：曲线在 $x > 0$ 和 $x < 0$ 的区域可能呈现一定的对称性。

### 问题3: 参数曲面绘制结果
![problem3_plot](https://github.com/user-attachments/assets/309a8f2b-653a-4b0e-be3e-de6fdea43337)

*(插入图片或截图并简要分析三维曲面的特点)*

参数曲面定义：
参数曲面由以下方程定义：

$x = e^{-s} \cdot \cos(t)$
$y = e^{-s} \cdot \sin(t)$
$z = t$
参数范围：

$s \in [0, 8]$
$t \in [0, 5\pi]$
绘制结果特点：
螺旋收缩特性：

参数 $s$ 控制曲面的收缩程度，随着 $s$ 增大，$e^{-s}$ 指数衰减，导致曲面在 $x$ 和 $y$ 方向逐渐收缩。
曲面呈现出一个螺旋状的结构，且螺旋的半径随着 $s$ 增大逐渐减小。
周期性：

参数 $t$ 控制曲面的旋转角度，$t$ 的范围为 $[0, 5\pi]$，因此曲面在 $z$ 方向上呈现 2.5 圈的螺旋。
对称性：

曲面在 $x$ 和 $y$ 平面上具有极坐标对称性，因为 $x$ 和 $y$ 的定义中包含 $\cos(t)$ 和 $\sin(t)$，它们共同决定了曲面的圆形截面。
三维特性：

曲面在 $z$ 方向上单调递增，随着 $t$ 的增大，$z$ 的值线性增加，形成一个沿 $z$ 轴延伸的螺旋曲面。

### **问题 3：参数曲面绘制结果**

#### **参数曲面定义：**
参数曲面由以下方程定义：
- $x = e^{-s} \cdot \cos(t)$
- $y = e^{-s} \cdot \sin(t)$
- $z = t$

参数范围：
- $s \in [0, 8]$
- $t \in [0, 5\pi]$

---

#### **绘制结果特点：**
1. **螺旋收缩特性：**
   - 参数 $s$ 控制曲面的收缩程度，随着 $s$ 增大，$e^{-s}$ 指数衰减，导致曲面在 $x$ 和 $y$ 方向逐渐收缩。
   - 曲面呈现出一个螺旋状的结构，且螺旋的半径随着 $s$ 增大逐渐减小。

2. **周期性：**
   - 参数 $t$ 控制曲面的旋转角度，$t$ 的范围为 $[0, 5\pi]$，因此曲面在 $z$ 方向上呈现 2.5 圈的螺旋。

3. **对称性：**
   - 曲面在 $x$ 和 $y$ 平面上具有极坐标对称性，因为 $x$ 和 $y$ 的定义中包含 $\cos(t)$ 和 $\sin(t)$，它们共同决定了曲面的圆形截面。

4. **三维特性：**
   - 曲面在 $z$ 方向上单调递增，随着 $t$ 的增大，$z$ 的值线性增加，形成一个沿 $z$ 轴延伸的螺旋曲面。

---

#### **绘图代码：**
以下是绘制三维参数曲面的代码实现：

```python
import sympy as sp
from sympy.plotting import plot3d_parametric_surface

def problem3():
    """
    绘制三维参数曲面
    """
    # 定义符号变量 s 和 t
    s, t = sp.symbols('s t')
    
    # 定义参数方程
    x = sp.exp(-s) * sp.cos(t)
    y = sp.exp(-s) * sp.sin(t)
    z = t
    
    # 绘制三维参数曲面
    plot3d_parametric_surface(
        x, y, z, 
        (s, 0, 8), (t, 0, 5*sp.pi),
        xlabel='x', ylabel='y', zlabel='z', title='3D Parametric Surface'
    )

problem3()
```

---

#### **运行结果：**
- 曲面呈现一个沿 $z$ 轴延伸的螺旋结构。
- 在 $s$ 增大的方向上，曲面的半径逐渐减小，形成一个逐渐收缩的螺旋。
- 在 $t$ 增大的方向上，曲面沿 $z$ 轴单调上升。

---

#### **简要分析：**
1. **螺旋收缩：**
   - 曲面在 $s$ 增大的方向上，$e^{-s}$ 指数衰减，导致曲面逐渐向 $z$ 轴收缩。
   - 这种收缩特性使得曲面在远离原点时变得更加紧凑。

2. **周期性旋转：**
   - 参数 $t$ 的周期性导致曲面在 $x$ 和 $y$ 平面上呈现圆形截面，且随着 $t$ 增大，曲面完成多圈旋转。

3. **三维延展：**
   - 曲面沿 $z$ 轴延展，形成一个三维的螺旋结构，具有明显的方向性。

---

## 五、实验总结与讨论

- 通过本实验你掌握了哪些绘图技巧？

- 答：
##### 基本函数绘图：

使用 sympy.plotting.plot 绘制一维函数图像，掌握了如何设置变量范围、坐标轴标签和标题。
学会处理复杂函数（如 $\cos(\tan(\pi x))$）的绘制。
##### 隐函数绘图：

使用 sympy.plotting.plot_implicit 绘制隐函数图像，掌握了如何定义隐函数表达式并设置合理的变量范围。
学会通过 points 参数提高图像的平滑度。
##### 三维参数曲面绘图：

使用 sympy.plotting.plot3d_parametric_surface 绘制三维参数曲面，掌握了如何定义参数方程并设置参数范围。
学会为三维图像添加坐标轴标签和标题。

- 实验中你遇到了哪些问题？如何解决？
  
- 答：
##### 模块未安装问题：

问题：运行代码时提示 ModuleNotFoundError: No module named 'sympy'。

解决：通过 pip install sympy 安装所需模块。
##### 绘图窗口无法显示：

问题：在某些环境中，matplotlib 的后端与 IDE 不兼容，导致绘图窗口无法正常显示。

解决：切换 matplotlib 的后端为 TkAgg 或使用非交互式后端 Agg 保存图像。
##### 隐函数间断问题：

问题：隐函数 $\frac{\cos x}{x}$ 在 $x=0$ 附近无定义，导致绘图失败或出现异常。

解决：通过设置合理的变量范围（如避开 $x=0$）解决问题。
##### 三维曲面渲染问题：

问题：三维参数曲面在某些范围内可能渲染不清晰。

解决：调整参数范围或增加采样点以提高图像质量。

- 你对SymPy的绘图功能有什么建议或意见？
  
- 答：
##### 优点：

SymPy 的绘图功能与符号计算无缝集成，能够直接绘制符号表达式，非常方便。

提供了多种绘图方法（如 plot、plot_implicit 和 plot3d_parametric_surface），覆盖了一维、二维和三维绘图需求。
##### 不足：

绘图功能的自定义选项较少，例如无法直接调整线条样式、颜色等。

隐函数绘图在处理间断性函数时需要手动设置范围，缺乏自动化处理能力。

三维绘图的渲染效果相较于其他专业绘图库（如 Matplotlib 或 Plotly）稍显不足。
##### 建议：

增强绘图功能的可定制性，例如支持更多的样式和颜色选项。

提供更智能的范围处理功能，自动避开间断点。

改进三维绘图的渲染效果，支持更高质量的图像输出。

通过本实验，熟悉了 SymPy 的基本绘图功能，并掌握了如何结合符号计算进行可视化分析，同时也发现了其在某些场景下的局限性。

---

## 六、参考文献

- SymPy官方文档：https://docs.sympy.org/latest/modules/plotting.html
